var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(x){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var G=x.document,j=function(){return x.URL||x.webkitURL||x},h=G.createElementNS("http://www.w3.org/1999/xhtml","a"),b="download" in h,m=function(c){var a=G.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,x,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(a)},C=x.webkitRequestFileSystem,A=x.requestFileSystem||C||x.mozRequestFileSystem,H=function(a){(x.setImmediate||x.setTimeout)(function(){throw a},0)},F="application/octet-stream",q=0,z=500,k=function(a){var c=function(){"string"==typeof a?j().revokeObjectURL(a):a.remove()};x.chrome?c():setTimeout(c,z)},E=function(f,c,p){c=[].concat(c);for(var l=c.length;l--;){var d=f["on"+c[l]];if("function"==typeof d){try{d.call(f,p||f)}catch(a){H(a)}}}},g=function(v,I){var n,a,u,r=this,c=v.type,e=!1,f=function(){E(r,"writestart progress write writeend".split(" "))},l=function(){if((e||!n)&&(n=j().createObjectURL(v)),a){a.location.href=n}else{var d=x.open(n,"_blank");void 0==d&&"undefined"!=typeof safari&&(x.location.href=n)}r.readyState=r.DONE,f(),k(n)},o=function(d){return function(){return r.readyState!==r.DONE?d.apply(this,arguments):void 0}},i={create:!0,exclusive:!1};return r.readyState=r.INIT,I||(I="download"),b?(n=j().createObjectURL(v),h.href=n,h.download=I,m(h),r.readyState=r.DONE,f(),void k(n)):(/^\s*(?:text\/(?:plain|xml)|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(v.type)&&(v=new Blob(["",v],{type:v.type})),x.chrome&&c&&c!==F&&(u=v.slice||v.webkitSlice,v=u.call(v,0,v.size,F),e=!0),C&&"download"!==I&&(I+=".download"),(c===F||C)&&(a=x),A?(q+=v.size,void A(x.TEMPORARY,q,o(function(d){d.root.getDirectory("saved",i,o(function(p){var s=function(){p.getFile(I,i,o(function(t){t.createWriter(o(function(w){w.onwriteend=function(y){a.location.href=t.toURL(),r.readyState=r.DONE,E(r,"writeend",y),k(t)},w.onerror=function(){var y=w.error;y.code!==y.ABORT_ERR&&l()},"writestart progress write abort".split(" ").forEach(function(y){w["on"+y]=r["on"+y]}),w.write(v),r.abort=function(){w.abort(),r.readyState=r.DONE},r.readyState=r.WRITING}),l)}),l)};p.getFile(I,{create:!1},o(function(t){t.remove(),s()}),o(function(t){t.code===t.NOT_FOUND_ERR?s():l()}))}),l)}),l)):void l())},D=g.prototype,B=function(c,a){return new g(c,a)};return D.abort=function(){var a=this;a.readyState=a.DONE,E(a,"abort")},D.readyState=D.INIT=0,D.WRITING=1,D.DONE=2,D.error=D.onwritestart=D.onprogress=D.onwrite=D.onabort=D.onerror=D.onwriteend=null,B}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return saveAs});var VCard;(function(){VCard=function(d){this.changed=false;if(typeof(d)==="object"){for(var c in d){this[c]=d[c];this.changed=true}}};VCard.prototype={validate:function(){var g=[];function f(a,b){g.push([a,b])}if(!this.fn){f("fn","required")}for(var e in VCard.multivaluedKeys){if(this[e]&&!(this[e] instanceof Array)){this[e]=[this[e]]}}function h(b,d){for(var c in d){var a=d[c];if(typeof(a)!=="object"){g.push([b+"-"+c,"not-an-object"])}else{if(!a.type){g.push([b+"-"+c,"missing-type"])}else{if(!a.value){g.push([b+"-"+c,"missing-value"])}}}}}if(this.email){h("email",this.email)}if(this.tel){h("email",this.tel)}if(!this.uid){this.addAttribute("uid",this.generateUID())}if(!this.rev){this.addAttribute("rev",this.generateRev())}this.errors=g;return !(g.length>0)},generateUID:function(){return"uuid:"+Math.uuid()},generateRev:function(){return(new Date()).toISOString().replace(/[\.\:\-]/g,"")},setAttribute:function(d,c){this[d]=c;this.changed=true},addAttribute:function(d,c){if(!c){return}if(VCard.multivaluedKeys[d]){if(this[d]){this[d].push(c)}else{this.setAttribute(d,[c])}}else{this.setAttribute(d,c)}},toJSON:function(){return JSON.stringify(this.toJCard())},toJCard:function(){var e={};for(var d in VCard.allKeys){var f=VCard.allKeys[d];if(this[f]){e[f]=this[f]}}return e},merge:function(f){if(typeof(f.uid)!=="undefined"&&typeof(this.uid)!=="undefined"&&f.uid!==this.uid){throw"Won't merge vcards without matching UIDs."}var d=new VCard();function e(a){if(f[a]){if(f[a]==this[a]){d.setAttribute(this[a])}else{d.addAttribute(this[a]);d.addAttribute(f[a])}}else{d[a]=this[a]}}for(key in this){e(key)}for(key in f){if(!d[key]){e(key)}}}};VCard.enums={telType:["text","voice","fax","cell","video","pager","textphone"],relatedType:["contact","acquaintance","friend","met","co-worker","colleague","co-resident","neighbor","child","parent","sibling","spouse","kin","muse","crush","date","sweetheart","me","agent","emergency"],emailType:["work","home","internet"],langType:["work","home"]};VCard.allKeys=["fn","n","nickname","photo","bday","anniversary","gender","tel","email","impp","lang","tz","geo","title","role","logo","org","member","related","categories","note","prodid","rev","sound","uid"];VCard.multivaluedKeys={email:true,tel:true,geo:true,title:true,role:true,logo:true,org:true,member:true,related:true,categories:true,note:true}})();var VCF;(function(){VCF={simpleKeys:["VERSION","FN","PHOTO","GEO","TITLE","ROLE","LOGO","MEMBER","NOTE","PRODID","SOUND","UID"],csvKeys:["NICKNAME","CATEGORIES"],dateAndOrTimeKeys:["BDAY","ANNIVERSARY","REV"],parse:function(f,g,e){var h=null;if(!e){e=this}this.lex(f,function(d,b,j){function c(i){if(h){h.addAttribute(d.toLowerCase(),i)}}if(d=="BEGIN"){h=new VCard()}else{if(d=="END"){if(h){g.apply(e,[h]);h=null}}else{if(this.simpleKeys.indexOf(d)!=-1){c(b)}else{if(this.csvKeys.indexOf(d)!=-1){c(b.split(","))}else{if(this.dateAndOrTimeKeys.indexOf(d)!=-1){if(j.VALUE=="text"){c(b)}else{if(j.CALSCALE&&j.CALSCALE!="gregorian"){}else{c(this.parseDateAndOrTime(b))}}}else{if(d=="N"){c(this.parseName(b))}else{if(d=="GENDER"){c(this.parseGender(b))}else{if(d=="TEL"){c({type:(j.TYPE||"voice"),pref:j.PREF,value:b})}else{if(d=="EMAIL"){c({type:j.TYPE,pref:j.PREF,value:b})}else{if(d=="IMPP"){c({value:b})}else{if(d=="LANG"){c({type:j.TYPE,pref:j.PREF,value:b})}else{if(d=="TZ"){if(j.VALUE=="utc-offset"){c({"utc-offset":this.parseTimezone(b)})}else{c({name:b})}}else{if(d=="ORG"){var a=b.split(";");c({"organization-name":a[0],"organization-unit":a[1]})}else{if(d=="RELATED"){c({type:j.TYPE,pref:j.PREF,value:j.VALUE})}else{if(d=="ADR"){c({type:j.TYPE,pref:j.PREF,value:b})}}}}}}}}}}}}}}}})},nameParts:["family-name","given-name","additional-name","honorific-prefix","honorific-suffix"],parseName:function(f){var h=f.split(";");var g={};for(var e in h){if(h[e]){g[this.nameParts[e]]=h[e].split(",")}}return g},parseGender:function(d){var e={};var f=d.split(";");switch(f[0]){case"M":e.sex="male";break;case"F":e.sex="female";break;case"O":e.sex="other"}if(f[1]){e.identity=f[1]}return e},dateRE:/^(\d{4})(\d{2})(\d{2})$/,dateReducedARE:/^(\d{4})\-(\d{2})$/,dateReducedBRE:/^(\d{4})$/,dateTruncatedMDRE:/^\-{2}(\d{2})(\d{2})$/,dateTruncatedDRE:/^\-{3}(\d{2})$/,timeRE:/^(\d{2})(\d{2})(\d{2})([+\-]\d+|Z|)$/,timeReducedARE:/^(\d{2})(\d{2})([+\-]\d+|Z|)$/,timeReducedBRE:/^(\d{2})([+\-]\d+|Z|)$/,timeTruncatedMSRE:/^\-{2}(\d{2})(\d{2})([+\-]\d+|Z|)$/,timeTruncatedSRE:/^\-{3}(\d{2})([+\-]\d+|Z|)$/,parseDate:function(k){var l;var i,h,j;if((l=k.match(this.dateRE))){i=l[1];h=l[2];j=l[3]}else{if((l=k.match(this.dateReducedARE))){i=l[1];h=l[2]}else{if((l=k.match(this.dateReducedBRE))){i=l[1]}else{if((l=k.match(this.dateTruncatedMDRE))){h=l[1];j=l[2]}else{if((l=k.match(this.dateTruncatedDRE))){j=l[1]}else{return null}}}}}var d=new Date(0);if(typeof(i)!="undefined"){d.setUTCFullYear(i)}if(typeof(h)!="undefined"){d.setUTCMonth(h-1)}if(typeof(j)!="undefined"){d.setUTCDate(j)}return d},parseTime:function(k){var l;var n,i,h,j;if((l=k.match(this.timeRE))){n=l[1];i=l[2];h=l[3];j=l[4]}else{if((l=k.match(this.timeReducedARE))){n=l[1];i=l[2];j=l[3]}else{if((l=k.match(this.timeReducedBRE))){n=l[1];j=l[2]}else{if((l=k.match(this.timeTruncatedMSRE))){i=l[1];h=l[2];j=l[3]}else{if((l=k.match(this.timeTruncatedSRE))){h=l[1];j=l[2]}else{return null}}}}}var m=new Date(0);if(typeof(n)!="undefined"){m.setUTCHours(n)}if(typeof(i)!="undefined"){m.setUTCMinutes(i)}if(typeof(h)!="undefined"){m.setUTCSeconds(h)}if(j){m=this.applyTimezone(m,j)}return m},addDates:function(a,j,c){if(typeof(c)=="undefined"){c=true}if(!a){return j}if(!j){return a}var k=Number(a);var l=Number(j);var b=c?k+l:k-l;return new Date(b)},parseTimezone:function(f){var e;if((e=f.match(/^([+\-])(\d{2})(\d{2})?/))){var d=new Date(0);d.setUTCHours(e[2]);d.setUTCMinutes(e[3]||0);return Number(d)*(e[1]=="+"?+1:-1)}else{return null}},applyTimezone:function(e,f){var d=this.parseTimezone(f);if(d){return new Date(Number(e)+d)}else{return e}},parseDateTime:function(d){var h=d.split("T");var f=this.parseDate(h[0]);var g=this.parseTime(h[1]);return this.addDates(f,g)},parseDateAndOrTime:function(b){switch(b.indexOf("T")){case 0:return this.parseTime(b.slice(1));case -1:return this.parseDate(b);default:return this.parseDateTime(b)}},lineRE:/^([^\s].*)(?:\r?\n|$)/,foldedLineRE:/^\s(.+)(?:\r?\n|$)/,lex:function(f,h){var i,g=null,j=0;for(;;){if((i=f.match(this.lineRE))){if(g&&g.indexOf("QUOTED-PRINTABLE")!=-1&&g.slice(-1)=="="){g=g.slice(0,-1)+i[1];j=i[0].length}else{if(g){this.lexLine(g,h)}g=i[1];j=i[0].length}}else{if((i=f.match(this.foldedLineRE))){if(g){g+=i[1];j=i[0].length}else{}}}f=f.slice(j);if(!f){break}}if(g){this.lexLine(g,h)}g=null},lexLine:function(c,i){var s="";var o=null,n={},q=null,u=null;var p=c.indexOf("ENCODING=QUOTED-PRINTABLE");if(p!=-1){c=c.substr(0,p)+this.decodeQP(c.substr(p+25))}function v(){if(o){if(u){n[u]=s.split(",")}else{if(s=="PREF"){n.PREF=1}else{if(n.TYPE){n.TYPE.push(s)}else{n.TYPE=[s]}}}}else{o=s}}for(var t in c){var r=c[t];switch(r){case":":v();q=c.slice(Number(t)+1);i.apply(this,[o,q,n]);return;case";":v();s="";break;case"=":u=s;s="";break;default:s+=r}}},decodeQP:function(g){g=(g||"").toString();g=g.replace(/\=(?:\r?\n|$)/g,"");var h="";for(var e=0,f=g.length;e<f;e++){chr=g.charAt(e);if(chr=="="&&(hex=g.substr(e+1,2))&&/[\da-fA-F]{2}/.test(hex)){h+=String.fromCharCode(parseInt(hex,16));e+=2;continue}h+=chr}return h}}})();jQuery.fn.sortElements=(function(){var a=[].sort;return function(c,d){d=d||function(){return this};var b=this.map(function(){var f=d.call(this),e=f.parentNode,g=e.insertBefore(document.createTextNode(""),f.nextSibling);return function(){if(e===this){throw new Error("You can't sort elements if any one is a descendant of another.")}e.insertBefore(this,g);e.removeChild(g)}});return a.call(this,c).each(function(e){b[e].call(d.call(this))})}})();